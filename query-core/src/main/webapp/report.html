<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
       <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
       <title>ICOS Carbon Data Portal - Usage Reports</title>
       <link rel="shortcut icon" href="img/icos.ico" />
       <link rel="stylesheet" type="text/css" href="js/ext3/resources/css/ext-all-notheme.css" />
       <link rel="stylesheet" type="text/css" href="js/ext3/resources/css/xtheme-gray.css" />
       <link rel="stylesheet" type="text/css" href="css/dataportal.css" />
       <script type="text/javascript" src="js/ext3/adapter/ext/ext-base-debug.js"></script>
       <script type="text/javascript" src="js/ext3/ext-all-debug-w-comments.js"></script>
<script>

Ext.onReady(function(){
    
    /* Downloads by Institution */
    var downloadsByInstitutionStore = new Ext.data.JsonStore({
        url: 'report?request=GetDownloadsByInstitution&year=2011&month=12',
        autoLoad: true,
        fields: ["institution", "downloads"]
    });
    
    var pieChart = new Ext.chart.PieChart({
        store: downloadsByInstitutionStore,
        categoryField: "institution",
        dataField: "downloads"
    });
    
    var piepanel = new Ext.Panel({
        title: "Downloads by Institution",
        items: [pieChart]
    });
    
    /* Downloads by Domain */
    var downloadsByDomainStore = new Ext.data.JsonStore({
        url: 'report?request=GetDownloadsByDomain&year=2011&month=12',
        autoLoad: true,
        fields: ["domain", "downloads"]
    });

    var columnChart = new Ext.chart.ColumnChart({
	    store: downloadsByDomainStore,
	    xField: "domain",
	    yField: "downloads"
	});

    var columnpanel = new Ext.Panel({
        title: "Downloads by Domain",
        items: [columnChart]
    });
    
    
    /* Downloads By Date */
    var downloadsByDateStore = new Ext.data.JsonStore({
        url: 'report?request=GetDownloadsByDate&year=2011&month=12',
        autoLoad: true,        
        fields: ["date", "downloads"]
    });

	var lineChart = new Ext.chart.LineChart({
	    store: downloadsByDateStore,
	    xField: "date",
	    yField: "downloads"
	});
	
	var linepanel = new Ext.Panel({
	    title: 'Downloads by Date',
	    items:[lineChart]
	});

	
	var main = new Ext.Viewport({
	    layout: 'border',
	    items:[{
	        region: 'north',
	        html: '<div id="header"><img src="img/icos-logo.png"/><div id="title">Usage Reports</div></div>'
	    },{
		    region: 'center',
		    autoScroll: true,
		    defaults: {
		        height:250,
		        width:600,
		        collapsible: true,
		        border: true,
		        titleCollapse: true
		    },
		    items: [piepanel, columnpanel, linepanel]
		},{
		    region: 'west',
		    width: 250,
		    items: [
		        new Ext.form.FormPanel({
		            labelAlign: 'top',
		            autoScroll: true,
		            height: 250,
		            border: true,
		            padding: 4,
		            items: [
		                new Ext.form.ComboBox({
		                    mode: 'local',
		                    fieldLabel: 'Periodicity',
		                    store: new Ext.data.SimpleStore({  
		                        fields: ['periodicity'],  
		                        data: [['Monthly Report'], ['Yearly Report']],
		                        id: 0
		                    }),
		                    displayField: 'periodicity',
		                    valueField: 'periodicity'
		                }),
	                    new Ext.form.ComboBox({
	                        mode: 'local',
	                        fieldLabel: 'Month',
	                        store: new Ext.data.SimpleStore({  
	                            fields: ['month'],  
	                            data: [['January'], ['February'], ['March'],
	                                   ['April'], ['May'], ['June'],
	                                   ['July'], ['August'], ['September'],
	                                   ['October'], ['November'], ['December']],
	                            id: 1
	                        }),
	                        displayField: 'month',
	                        valueField: 'month'
	                    }),
	                    new Ext.form.ComboBox({
	                        mode: 'local',
	                        fieldLabel: 'Year',
	                        store: new Ext.data.SimpleStore({  
	                            fields: ['year'],  
	                            data: [['2011'], ['2010'], ['2009']],
	                            id: 2
	                        }),
	                        displayField: 'year',
	                        valueField: 'year'
	                    })
		            ],
		            buttons: [{
		                text: 'Generate report >>'
		            }]		            
		        }) 
		    ]
		}]
	});

});
</script>
</head>
<body>
</body>
</html>